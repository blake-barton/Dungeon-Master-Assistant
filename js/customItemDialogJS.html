<script>

    function sanitizeInput(name)
    {
        // check for empty string
        if (name === "")
        {
            alert("Name cannot be blank.");
            return true;
        }

        // return false if no error
        return false;
    }

    function getResults(formID)
    {
        let form = document.getElementById(formID);
        let errorFlag = sanitizeInput(form.name.value);

        if (!errorFlag)
        {
            let newItem = {
                "name": form.name.value,
                "Descriptors": {
                    "rarity": form.rarity.value,
                    "attunement": form.attunement.value,
                    "typeofitem": form.typeofitem.value,
                    "description": form.description.value
                }
            }

            google.script.run.appendJSON(newItem, 'DMAssistantItems', 'itemList.json');
            alert(newItem.name + " successfully created.");
            google.script.host.close();
        }
    }
    
</script>