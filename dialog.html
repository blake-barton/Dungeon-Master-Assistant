<!DOCTYPE html>
<html>
    <head>
        <base target="_top">
        
        <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
        <!-- The CSS package above applies Google styling to buttons and other elements. -->
        <style>
            table.ability-scores {
                table-layout: fixed;
                width: 600px;
            }
            table.ability-scores td {
                font-weight: bold;
                text-align: center;
            }
            table.ability-scores td input {
                text-align: center;
            }
            .add-button {
                margin-left: 5px;
            }
            td input {
                margin-left: 5px !important;
            }
            td select {
                margin-left: 5px !important;
            }
            td input[type=number] {
                width: 60px !important;
            }
        </style>
    </head>
    <body>
        <form id="monsterForm" action="" method="GET">
            <h3>Descriptors</h3>
            <table>
                <tr>
                    <td><label for="name">Name:</label></td>
                    <td><input type="text" id="name" name="name"></td>
                </tr>
                <tr>
                    <td><label for="type">Type:</label></td>
                    <td>
                        <select name="type" id="type">
                            <option value="Aberration">Aberration</option>
                            <option value="Beast">Beast</option>
                            <option value="Celestial">Celestial</option>
                            <option value="Construct">Construct</option>
                            <option value="Dragon">Dragon</option>
                            <option value="Elemental">Elemental</option>
                            <option value="Fey">Fey</option>
                            <option value="Fiend">Fiend</option>
                            <option value="Giant">Giant</option>
                            <option value="Humanoid">Humanoid</option>
                            <option value="Monstrosity">Monstrosity</option>
                            <option value="Ooze">Ooze</option>
                            <option value="Plant">Plant</option>
                            <option value="Undead">Undead</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td><label for="size">Size:</label></td>
                    <td>
                        <select name="size" id="size">
                            <option value="Tiny">Tiny</option>
                            <option value="Small">Small</option>
                            <option value="Medium">Medium</option>
                            <option value="Large">Large</option>
                            <option value="Huge">Huge</option>
                            <option value="Gargantuan">Gargantuan</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td><label for="alignment">Alignment:</label></td>
                    <td>
                        <select name="alignment" id="alignment">
                            <option value="Lawful Good">Lawful Good</option>
                            <option value="Neutral Good">Neutral Good</option>
                            <option value="Chaotic Good">Chaotic Good</option>
                            <option value="Lawful Neutral">Lawful Neutral</option>
                            <option value="Neutral">Neutral</option>
                            <option value="Chaotic Neutral">Chaotic Neutral</option>
                            <option value="Lawful Evil">Lawful Evil</option>
                            <option value="Neutral Evil">Neutral Evil</option>
                            <option value="Chaotic Evil">Chaotic Evil</option>
                            <option value="Unaligned">Unaligned</option>
                        </select>
                    </td>
                </tr>
            </table>
            <hr>
            <h3>Numeric Stats</h3>
            <table>
                <tr>
                    <td><label for="ac">Armor Class:</label></td>
                    <td><input type="number" id="ac" name="ac" size="5" min="0"></td>
                </tr>
                <tr>
                    <td><label for="hp">Hit Points:</label></td>
                    <td><input type="number" id="hp" name="hp" size="5" min="0"></td>
                </tr>
                <tr>
                    <td><label for="land-speed">Speeds:</label></td>
                    <td><input type="number" id="land-speed" name="landSpeed" placeholder="Land" size="5" min="0"></td>
                    <td><input type="number" id="fly-speed" name="flySpeed" placeholder="Fly" size="5" min="0"></td>
                    <td><input type="number" id="swim-speed" name="swimSpeed" placeholder="Swim" size="5" min="0"></td>
                </tr>
                <tr>
                    <td><label for="cr">Challenge Rating:</label></td>
                    <td><input type="number" id="cr" name="cr" size="5" min="0"></td>
                </tr>
            </table>
            <hr>
            <h3>Ability Scores</h3>
            <table class="ability-scores">
                <tr>
                    <td>STR</td>
                    <td>DEX</td>
                    <td>CON</td>
                    <td>INT</td>
                    <td>WIS</td>
                    <td>CHA</td>
                </tr>
                <tr>
                    <td><input type="number" id="str" name="str" size="9" maxlength="2" min="0"></td>
                    <td><input type="number" id="dex" name="dex" size="9" maxlength="2" min="0"></td>
                    <td><input type="number" id="con" name="con" size="9" maxlength="2" min="0"></td>
                    <td><input type="number" id="int" name="int" size="9" maxlength="2" min="0"></td>
                    <td><input type="number" id="wis" name="wis" size="9" maxlength="2" min="0"></td>
                    <td><input type="number" id="cha" name="cha" size="9" maxlength="2" min="0"></td>
                </tr>
            </table>
            <hr>
            <h3>Saving Throws</h3>
            <table class ="ability-scores">
                <tr>
                    <td>STR</td>
                    <td>DEX</td>
                    <td>CON</td>
                    <td>INT</td>
                    <td>WIS</td>
                    <td>CHA</td>
                </tr>
                <tr>
                    <td><input type="number" id="save-str" name="saveStr" size="9" maxlength="2"></td>
                    <td><input type="number" id="save-dex" name="saveDex" size="9" maxlength="2"></td>
                    <td><input type="number" id="save-con" name="saveCon" size="9" maxlength="2"></td>
                    <td><input type="number" id="save-int" name="saveInt" size="9" maxlength="2"></td>
                    <td><input type="number" id="save-wis" name="saveWis" size="9" maxlength="2"></td>
                    <td><input type="number" id="save-cha" name="saveCha" size="9" maxlength="2"></td>
                </tr>
            </table>
            <hr>
            <h3>Passives</h3>
            <table>
                <tr>
                    <td><label for="pass-perception">Passive Perception:</label></td>
                    <td><input type="number" id="pass-perception" name="passPerception" size="5" min="0"></td>
                </tr>
                <tr id="sense-row0">
                    <td><label for="sense0">Senses:</label></td>
                    <td>
                        <select name="sense0" id="sense0">
                            <option value="None">None</option>
                            <option value="Blindsight">Blindsight</option>
                            <option value="Darkvision">Darkvision</option>
                            <option value="Tremorsense">Tremorsense</option>
                            <option value="Truesight">Truesight</option>
                        </select>
                    </td>
                    <td><input type="number" id="sense-range0" name="senseRange0" min="0" placeholder="ft."></td>
                    <td><button type="button" class="add-button" onclick="generateSelectInput('sense-row0')">+</button></td>
                </tr>
                <tr id="skill-row0">
                    <td><label for="skill0">Skills:</label></td>
                    <td>
                        <select name="skill0" id="skill0">
                            <option value="None">None</option>
                            <option value="Acrobatics">Acrobatics (dex)</option>
                            <option value="Animal Handling">Animal Handling (wis)</option>
                            <option value="Arcana">Arcana (int)</option>
                            <option value="Athletics">Athletics (str)</option>
                            <option value="Deception">Deception (cha)</option>
                            <option value="History">History (int)</option>
                            <option value="Insight">Insight (wis)</option>
                            <option value="Intimidation">Intimidation (cha)</option>
                            <option value="Investigation">Investigation (int)</option>
                            <option value="Medicine">Medicine (wis)</option>
                            <option value="Nature">Nature (int)</option>
                            <option value="Performance">Performance (cha)</option>
                            <option value="Persuasion">Persuasion (cha)</option>
                            <option value="Religion">Religion (int)</option>
                            <option value="Sleight of Hand">Sleight of Hand (dex)</option>
                            <option value="Stealth">Stealth (dex)</option>
                            <option value="Survival">Survival (wis)</option>
                        </select>
                    </td>
                    <td><input type="number" id="skill-mod0" name="skillMod0" min="0" placeholder="+mod"></td>
                    <td><button type="button" class="add-button" onclick="generateSelectInput('skill-row0')">+</button></td>
                </tr>
                <tr id="language-row0">
                    <td><label for="language0">Languages:</label></td>
                    <td>
                        <select name="language0" id="language0">
                            <option value="None">None</option>
                            <option value="Common">Common</option>
                            <option value="Dwarvish">Dwarvish</option>
                            <option value="Elvish">Elvish</option>
                            <option value="Giant">Giant</option>
                            <option value="Gnomish">Gnomish</option>
                            <option value="Goblin">Goblin</option>
                            <option value="Halfling">Halfling</option>
                            <option value="Orc">Orc</option>
                            <option value="Abyssal">Abyssal</option>
                            <option value="Celestial">Celestial</option>
                            <option value="Draconic">Draconic</option>
                            <option value="Deep-speech">Deep Speech</option>
                            <option value="Infernal">Infernal</option>
                            <option value="Primordial">Primordial</option>
                            <option value="Sylvan">Sylvan</option>
                            <option value="Undercommon">Undercommon</option>
                        </select>
                    </td>
                    <td><button type="button" class="add-button" onclick="generateSelect('language-row0')">+</button></td>
                </tr>
                <tr id="resistance-row0">
                    <td><label for="resistance0">Resistances:</label></td>
                    <td>
                        <select name="resistance0" id="resistance0">
                            <option value="None">None</option>
                            <option value="Acid">Acid</option>
                            <option value="Bludgeoning (non-magical)">Bludgeoning (non-magical)</option>
                            <option value="Bludgeoning (magical)">Bludgeoning (magical)</option>
                            <option value="Cold">Cold</option>
                            <option value="Fire">Fire</option>
                            <option value="Force">Force</option>
                            <option value="Lightning">Lightning</option>
                            <option value="Necrotic">Necrotic</option>
                            <option value="Piercing (non-magical)">Piercing (non-magical)</option>
                            <option value="Piercing (magical)">Piercing (magical)</option>
                            <option value="Poison">Poison</option>
                            <option value="Psychic">Psychic</option>
                            <option value="Radiant">Radiant</option>
                            <option value="Slashing (non-magical)">Slashing (non-magical)</option>
                            <option value="Slashing (magical)">Slashing (magical)</option>
                            <option value="thunder">Thunder</option>
                        </select>
                    </td>
                    <td><button type="button" class="add-button" onclick="generateSelect('resistance-row0')">+</button></td>
                </tr>
                <tr id="immunity-row0">
                    <td><label for="immunity0">Immunities:</label></td>
                    <td>
                        <select name="immunity0" id="immunity0">
                            <option value="None">None</option>
                            <option value="Acid">Acid</option>
                            <option value="Bludgeoning (non-magical)">Bludgeoning (non-magical)</option>
                            <option value="Bludgeoning (magical)">Bludgeoning (magical)</option>
                            <option value="Cold">Cold</option>
                            <option value="Fire">Fire</option>
                            <option value="Force">Force</option>
                            <option value="Lightning">Lightning</option>
                            <option value="Necrotic">Necrotic</option>
                            <option value="Piercing (non-magical)">Piercing (non-magical)</option>
                            <option value="Piercing (magical)">Piercing (magical)</option>
                            <option value="Poison">Poison</option>
                            <option value="Psychic">Psychic</option>
                            <option value="Radiant">Radiant</option>
                            <option value="Slashing (non-magical)">Slashing (non-magical)</option>
                            <option value="Slashing (magical)">Slashing (magical)</option>
                            <option value="thunder">Thunder</option>
                        </select>
                    </td>
                    <td><button type="button" class="add-button" onclick="generateSelect('immunity-row0')">+</button></td>
                </tr>
                <tr id="c-immunity-row0">
                    <td><label for="c-immunity0">Condition Immunities:</label></td>
                    <td>
                        <select name="cImmunity0" id="c-immunity0">
                            <option value="None">None</option>
                            <option value="Blinded">Blinded</option>
                            <option value="Charmed">Charmed</option>
                            <option value="Deafened">Deafened</option>
                            <option value="Exhaustion">Exhaustion</option>
                            <option value="Frightened">Frightened</option>
                            <option value="Grappled">Grappled</option>
                            <option value="Paralyzed">Paralyzed</option>
                            <option value="Petrified">Petrified</option>
                            <option value="Poisoned">Poisoned</option>
                            <option value="Prone">Prone</option>
                            <option value="Restrained">Restrained</option>
                            <option value="Stunned">Stunned</option>
                            <option value="Unconscious">Unconscious</option>
                        </select>
                    </td>
                    <td><button type="button" class="add-button" onclick="generateSelect('c-immunity-row0')">+</button></td>
                </tr>
            </table>
            <hr>
            <h3>Special Passives</h3>
            <table>
                <tr id="s-passive-row0">
                    <td><label for="s-passive0">Special Passives:</label></td>
                    <td><input type="text" id="s-passive0" name="sPassive0" placeholder="Name"></td>
                    <td><input type="text" id="s-passive-desc0" name="sPassiveDesc0" placeholder="Description"></td>
                    <td><button type="button" class="add-button" onclick="generateInputInput('s-passive-row0')">+</button></td>
                </tr>
            </table>
            <hr>
            <h3>Spellcasting</h3>
            <table>
                <tr>
                    <td><label for="cast-level">Cast Level:</label></td>
                    <td><input type="number" id="cast-level" name="castLevel" size="5" min="0"></td>
                </tr>
                <tr>
                    <td><label for="cast-ability">Cast Ability:</label></td>
                    <td>
                        <select name="castAbility" id="cast-ability">
                            <option value="None">None</option>
                            <option value="Strength">Strength</option>
                            <option value="Dexterity">Dexterity</option>
                            <option value="Constitution">Constitution</option>
                            <option value="Intelligence">Intelligence</option>
                            <option value="Wisdom">Wisdom</option>
                            <option value="Charisma">Charisma</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td><label for="save-dc">Spell Save DC:</label></td>
                    <td><input type="number" id="save-dc" name="saveDC" size="5" min="0"></td>
                </tr>
                <tr>
                    <td><label for="spell-attack-bonus">Spell Attack Bonus:</label></td>
                    <td><input type="number" id="spell-attack-bonus" name="spellAttackBonus" size="5"></td>
                </tr>
            </table>
            <h4>Spell slots</h4>
            <table class="ability-scores">
                <tr>
                    <td>1</td>
                    <td>2</td>
                    <td>3</td>
                    <td>4</td>
                    <td>5</td>
                    <td>6</td>
                    <td>7</td>
                    <td>8</td>
                    <td>9</td>
                </tr>
                <tr>
                    <td><input type="number" id="slot1" name="slot1" size="4" maxlength="2" min="0"></td>
                    <td><input type="number" id="slot2" name="slot2" size="4" maxlength="2" min="0"></td>
                    <td><input type="number" id="slot3" name="slot3" size="4" maxlength="2" min="0"></td>
                    <td><input type="number" id="slot4" name="slot4" size="4" maxlength="2" min="0"></td>
                    <td><input type="number" id="slot5" name="slot5" size="4" maxlength="2" min="0"></td>
                    <td><input type="number" id="slot6" name="slot6" size="4" maxlength="2" min="0"></td>
                    <td><input type="number" id="slot7" name="slot7" size="4" maxlength="2" min="0"></td>
                    <td><input type="number" id="slot8" name="slot8" size="4" maxlength="2" min="0"></td>
                    <td><input type="number" id="slot9" name="slot9" size="4" maxlength="2" min="0"></td>
                </tr>
            </table>
            <h4>Spells</h4>
            <table>
                <tr id="cantrip-row0">
                    <td><label for="level0-0">Cantrips:</label></td>
                    <td><input type="text" id="level0-0" name="level0_0"></td>
                    <td><button type="button" class="add-button" onclick="generateInput('cantrip-row0')">+</button></td>
                </tr>
                <tr id="spell-level1-row0">
                    <td><label for="level1-0">1st Level:</label></td>
                    <td><input type="text" id="level1-0" name="level1_0"></td>
                    <td><button type="button" class="add-button" onclick="generateInput('spell-level1-row0')">+</button></td>
                </tr>
                <tr id="spell-level2-row0">
                    <td><label for="level2-0">2nd Level:</label></td>
                    <td><input type="text" id="level2-0" name="level2_0"></td>
                    <td><button type="button" class="add-button" onclick="generateInput('spell-level2-row0')">+</button></td>
                </tr>
                <tr id="spell-level3-row0">
                    <td><label for="level3-0">3rd Level:</label></td>
                    <td><input type="text" id="level3-0" name="level3_0"></td>
                    <td><button type="button" class="add-button" onclick="generateInput('spell-level3-row0')">+</button></td>
                </tr>
                <tr id="spell-level4-row0">
                    <td><label for="level4-0">4th Level:</label></td>
                    <td><input type="text" id="level4-0" name="level4_0"></td>
                    <td><button type="button" class="add-button" onclick="generateInput('spell-level4-row0')">+</button></td>
                </tr>
                <tr id="spell-level5-row0">
                    <td><label for="level5-0">5th Level:</label></td>
                    <td><input type="text" id="level5-0" name="level5_0"></td>
                    <td><button type="button" class="add-button" onclick="generateInput('spell-level5-row0')">+</button></td>
                </tr>
                <tr id="spell-level6-row0">
                    <td><label for="level6-0">6th Level:</label></td>
                    <td><input type="text" id="level6-0" name="level6_0"></td>
                    <td><button type="button" class="add-button" onclick="generateInput('spell-level6-row0')">+</button></td>
                </tr>
                <tr id="spell-level7-row0">
                    <td><label for="level7-0">7th Level:</label></td>
                    <td><input type="text" id="level7-0" name="level7_0"></td>
                    <td><button type="button" class="add-button" onclick="generateInput('spell-level7-row0')">+</button></td>
                </tr>
                <tr id="spell-level8-row0">
                    <td><label for="level8-0">8th Level:</label></td>
                    <td><input type="text" id="level8-0" name="level8_0"></td>
                    <td><button type="button" class="add-button" onclick="generateInput('spell-level8-row0')">+</button></td>
                </tr>
                <tr id="spell-level9-row0">
                    <td><label for="level9-0">9th Level:</label></td>
                    <td><input type="text" id="level9-0" name="level9_0"></td>
                    <td><button type="button" class="add-button" onclick="generateInput('spell-level9-row0')">+</button></td>
                </tr>
            </table>
            <hr>
            <h3>Actions</h3>
            <table>
                <tr id="action-row0">
                    <td><label for="action0">Actions:</label></td>
                    <td><input type="text" id="action0" name="action0" placeholder="Name"></td>
                    <td><input type="text" id="action-desc0" name="actionDesc0" placeholder="Description"></td>
                    <td><button type="button" class="add-button" onclick="generateInputInput('action-row0')">+</button></td>
                </tr>
                <tr id="le-action-row0">
                    <td><label for="le-action0">Legendary Actions:</label></td>
                    <td><input type="text" id="le-action0" name="leAction0" placeholder="Name"></td>
                    <td><input type="text" id="le-action-desc0" name="leActionDesc0" placeholder="Description"></td>
                    <td><button type="button" class="add-button" onclick="generateInputInput('le-action-row0')">+</button></td>
                </tr>
            </table>
            <hr>
            <h3>Reactions</h3>
            <table>
                <tr id="reaction-row0">
                    <td><label for="reaction0">Reactions:</label></td>
                    <td><input type="text" id="reaction0" name="reaction0" placeholder="Name"></td>
                    <td><input type="text" id="reaction-desc0" name="reactionDesc0" placeholder="Description"></td>
                    <td><button type="button" class="add-button" onclick="generateInputInput('reaction-row0')">+</button></td>
                </tr>
            </table>
            <br>
        </form>
        <div class="block" id="submit-bar">
            <button type="submit" class="blue" id="save" onclick="getResults('monsterForm')">Save Custom Monster</button>
            <input type="button" value="Cancel" onclick="google.script.host.close()" />
        </div>

        <script>

            // call on its own to insert a new element after the reference
            function insertAfter(newNode, referenceNode)
            {
                referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);
            }

            function incrementIdNumber(id)
            {
                // get number off of rowID
                let num = id.charAt(id.length - 1);
                
                // increment num;
                num++;

                // cut off rowID number
                let cutID = id.substring(0, id.length - 1);

                // change clone id
                return cutID + num;
            }

            function getHomeRow(id)
            {
                // cut off rowID number
                let cutID = id.substring(0, id.length - 1);

                // change clone id
                return cutID + '0';
            }

            function generateSelectInput(rowID)
            {   
                // get row
                let row = document.getElementById(rowID);

                // clone row
                let clone = row.cloneNode(true);

                // change clone id
                clone.id = incrementIdNumber(rowID);

                // get original children ids
                let labelFor = row.getElementsByTagName('label')[0].htmlFor;
                let selectName = row.getElementsByTagName('select')[0].name;
                let selectID = row.getElementsByTagName('select')[0].id;
                let inputID = row.getElementsByTagName('input')[0].id;
                let inputName = row.getElementsByTagName('input')[0].name;

                // change button function of home row
                homeRow = document.getElementById(getHomeRow(row.id));
                homeRow.getElementsByTagName('button')[0].setAttribute("onClick", "generateSelectInput('" + clone.id + "')");
                
                // change clone children ids
                clone.getElementsByTagName('label')[0].htmlFor = incrementIdNumber(labelFor);
                clone.getElementsByTagName('select')[0].name = incrementIdNumber(selectName);
                clone.getElementsByTagName('select')[0].id = incrementIdNumber(selectID);
                clone.getElementsByTagName('input')[0].id = incrementIdNumber(inputID);
                clone.getElementsByTagName('input')[0].name = incrementIdNumber(inputName);

                // empty clone label
                clone.getElementsByTagName('label')[0].innerHTML = "";

                // cut the button td
                if (clone.getElementsByTagName('button').length > 0)
                {
                    console.log('there is a button in the clone');
                    clone.deleteCell(-1);
                }
                
                // insert clone
                insertAfter(clone, row);
            }

            function generateSelect(rowID)
            {
                // get row
                let row = document.getElementById(rowID);

                // clone row
                let clone = row.cloneNode(true);

                // change clone id
                clone.id = incrementIdNumber(rowID);

                // get original children ids
                let labelFor = row.getElementsByTagName('label')[0].htmlFor;
                let selectName = row.getElementsByTagName('select')[0].name;
                let selectID = row.getElementsByTagName('select')[0].id;

                // change button function of home row
                homeRow = document.getElementById(getHomeRow(row.id));
                homeRow.getElementsByTagName('button')[0].setAttribute("onClick", "generateSelect('" + clone.id + "')");

                // change clone children ids
                clone.getElementsByTagName('label')[0].htmlFor = incrementIdNumber(labelFor);
                clone.getElementsByTagName('select')[0].name = incrementIdNumber(selectName);
                clone.getElementsByTagName('select')[0].id = incrementIdNumber(selectID);

                // empty clone label
                clone.getElementsByTagName('label')[0].innerHTML = "";

                // cut the button td
                if (clone.getElementsByTagName('button').length > 0)
                {
                    console.log('there is a button in the clone');
                    clone.deleteCell(-1);
                }
                
                // insert clone
                insertAfter(clone, row);
            }

            function generateInput(rowID)
            {
                // get row
                let row = document.getElementById(rowID);

                // clone row
                let clone = row.cloneNode(true);

                // change clone id
                clone.id = incrementIdNumber(rowID);

                // get original children ids
                let labelFor = row.getElementsByTagName('label')[0].htmlFor;
                let inputID = row.getElementsByTagName('input')[0].id;
                let inputName = row.getElementsByTagName('input')[0].name;

                // change button function of home row
                homeRow = document.getElementById(getHomeRow(row.id));
                homeRow.getElementsByTagName('button')[0].setAttribute("onClick", "generateInput('" + clone.id + "')");

                // change clone children ids
                clone.getElementsByTagName('label')[0].htmlFor = incrementIdNumber(labelFor);
                clone.getElementsByTagName('input')[0].id = incrementIdNumber(inputID);
                clone.getElementsByTagName('input')[0].name = incrementIdNumber(inputName);

                // empty clone label
                clone.getElementsByTagName('label')[0].innerHTML = "";

                // cut the button td
                if (clone.getElementsByTagName('button').length > 0)
                {
                    console.log('there is a button in the clone');
                    clone.deleteCell(-1);
                }
                
                // insert clone
                insertAfter(clone, row);
            }

            function generateInputInput(rowID)
            {
                // get row
                let row = document.getElementById(rowID);

                // clone row
                let clone = row.cloneNode(true);

                // change clone id
                clone.id = incrementIdNumber(rowID);

                // get original children ids
                let labelFor = row.getElementsByTagName('label')[0].htmlFor;
                let inputID0 = row.getElementsByTagName('input')[0].id;
                let inputName0 = row.getElementsByTagName('input')[0].name;
                let inputID1 = row.getElementsByTagName('input')[1].id;
                let inputName1 = row.getElementsByTagName('input')[1].name;

                // change button function of home row
                homeRow = document.getElementById(getHomeRow(row.id));
                homeRow.getElementsByTagName('button')[0].setAttribute("onClick", "generateInputInput('" + clone.id + "')");

                // change clone children ids
                clone.getElementsByTagName('label')[0].htmlFor = incrementIdNumber(labelFor);
                clone.getElementsByTagName('input')[0].id = incrementIdNumber(inputID0);
                clone.getElementsByTagName('input')[0].name = incrementIdNumber(inputName0);
                clone.getElementsByTagName('input')[1].id = incrementIdNumber(inputID1);
                clone.getElementsByTagName('input')[1].name = incrementIdNumber(inputName1);

                // empty clone label
                clone.getElementsByTagName('label')[0].innerHTML = "";

                // cut the button td
                if (clone.getElementsByTagName('button').length > 0)
                {
                    console.log('there is a button in the clone');
                    clone.deleteCell(-1);
                }
                
                // insert clone
                insertAfter(clone, row);
            }

            function selectInputResults(form, rowID, selectName, inputName)
            {
                returnArray = [];
                let currentVals = [];

                // push sense to current sense
                currentVals.push(form[selectName].value);
                currentVals.push(form[inputName].value);

                // push current sense to senses array
                returnArray.push(currentVals);
                currentVals = [];

                // loop through the senses rows
                homeRow = document.getElementById(rowID);
                let currentRow = homeRow;
                let siblingID;
                let rowCount = 1;
                while(true)
                {
                    currentRow = currentRow.nextElementSibling;

                    if (currentRow == null)
                    {
                        break;
                    }

                    siblingID = currentRow.id;
                    if (siblingID.substring(0, siblingID.length - 1) === rowID.substring(0, rowID.length - 1))
                    {
                        selectName = selectName.substring(0, selectName.length - 1) + rowCount;
                        inputName = inputName.substring(0, inputName.length - 1) + rowCount;
                        currentVals.push(form[selectName].value);
                        currentVals.push(form[inputName].value);
                        returnArray.push(currentVals);
                        currentVals = [];
                        rowCount++;
                    }
                    else
                    {
                        break;
                    }
                }

                return returnArray;
            }

            function selectResults(form, rowID, selectName)
            {
                returnArray = [];
                currentVal = "";

                // push current sense to senses array
                returnArray.push(form[selectName].value);

                // loop through the senses rows
                homeRow = document.getElementById(rowID);
                let currentRow = homeRow;
                let siblingID;
                let rowCount = 1;
                while(true)
                {
                    currentRow = currentRow.nextElementSibling;
                    
                    if (currentRow != null)
                    {
                        siblingID = currentRow.id;
                        if (siblingID.substring(0, siblingID.length - 1) === rowID.substring(0, rowID.length - 1))
                        {
                            currentVal = selectName.substring(0, selectName.length - 1) + rowCount;
                            returnArray.push(form[currentVal].value);
                            currentVal = "";
                            rowCount++;
                        }
                    }
                    else
                    {
                        break;
                    }
                }

                return returnArray;
            }

            function getResults(formID)
            {
                let form = document.getElementById(formID);

                // calculate passives
                let senses = selectInputResults(form, "sense-row0", "sense0", "senseRange0");
                let skills = selectInputResults(form, "skill-row0", "skill0", "skillMod0");
                let languages = selectResults(form, "language-row0", "language0");
                let resistances = selectResults(form, "resistance-row0", "resistance0");
                let immunities = selectResults(form, "immunity-row0", "immunity0");
                let conditionImmunities = selectResults(form, "c-immunity-row0", "cImmunity0");

                // special passives
                let specialPassives = selectInputResults(form, "s-passive-row0", "sPassive0", "sPassiveDesc0");

                // spells
                let cantrips = selectResults(form, "cantrip-row0", "level0_0");
                let level1 = selectResults(form, "spell-level1-row0", "level1_0");
                let level2 = selectResults(form, "spell-level2-row0", "level2_0");
                let level3 = selectResults(form, "spell-level3-row0", "level3_0");
                let level4 = selectResults(form, "spell-level4-row0", "level4_0");
                let level5 = selectResults(form, "spell-level5-row0", "level5_0");
                let level6 = selectResults(form, "spell-level6-row0", "level6_0");
                let level7 = selectResults(form, "spell-level7-row0", "level7_0");
                let level8 = selectResults(form, "spell-level8-row0", "level8_0");
                let level9 = selectResults(form, "spell-level9-row0", "level9_0");

                // actions
                let actions = selectInputResults(form, "action-row0", "action0", "actionDesc0");
                let legendaryActions = selectInputResults(form, "le-action-row0", "leAction0", "leActionDesc0");

                // reactions
                let reactions = selectInputResults(form, "reaction-row0", "reaction0", "reactionDesc0");
                
                let newMonster = {
                    "name": form.name.value,
                    "Descriptors": {
                        "type": form.type.value,
                        "size": form.size.value,
                        "alignment": form.alignment.value
                    },
                    "NumericStats": {
                        "ac": form.ac.value,
                        "hp": form.hp.value,
                        "Speeds": {
                            "land": form.landSpeed.value,
                            "fly": form.flySpeed.value,
                            "swim": form.swimSpeed.value
                        },
                        "cr": form.cr.value,
                    },
                    "AbilityScores": {
                        "str": form.str.value,
                        "dex": form.dex.value,
                        "con": form.con.value,
                        "int": form.int.value,
                        "wis": form.wis.value,
                        "cha": form.cha.value 
                    },
                    "SavingThrows": {
                        "str": form.saveStr.value,
                        "dex": form.saveDex.value,
                        "con": form.saveCon.value,
                        "int": form.saveInt.value,
                        "wis": form.saveWis.value,
                        "cha": form.saveCha.value 
                    },
                    "Passives": {
                        "passivePerception": form.passPerception.value,
                        "senses": senses,
                        "skills": skills,
                        "languages": languages,
                        "resistances": resistances,
                        "immunities": immunities,
                        "conditionImmunities": conditionImmunities
                    },
                    "SpecialPassives": specialPassives,
                    "Spellcasting": {
                        "castLevel": form.castLevel.value,
                        "castAbility": form.castAbility.value,
                        "saveDC": form.saveDC.value,
                        "spellAttackBonus": form.spellAttackBonus.value,
                        "SpellSlots": {
                            "slot1": form.slot1.value,
                            "slot2": form.slot2.value,
                            "slot3": form.slot3.value,
                            "slot4": form.slot4.value,
                            "slot5": form.slot5.value,
                            "slot6": form.slot6.value,
                            "slot7": form.slot7.value,
                            "slot8": form.slot8.value,
                            "slot9": form.slot9.value,
                        },
                        "Spells": {
                            "cantrips": cantrips,
                            "level1": level1,
                            "level2": level2,
                            "level3": level3,
                            "level4": level4,
                            "level5": level5,
                            "level6": level6,
                            "level7": level7,
                            "level8": level8,
                            "level9": level9,
                        }
                    },
                    "Actions": {
                        "actions": actions,
                        "legendaryActions": legendaryActions
                    },
                    "Reactions": reactions
                }

                let monsterJSON = JSON.stringify(newMonster);
                let filename = newMonster.name + ".json";

                google.script.run.createMonsterJSON(filename, monsterJSON, newMonster.name);
                alert(filename + " successfully created.");
                google.script.host.close();
            }
        </script>
    </body>
</html>