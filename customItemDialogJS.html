<script>

    function sanitizeInput(name)
    {
        // check for quotes
        if (name.includes('"'))
        {
            alert("Name cannot contain quotation marks.");
            return true;
        }

        // check for empty string
        if (name === "")
        {
            alert("Name cannot be blank.");
            return true;
        }

        if (name.includes("(") || name.includes(")"))
        {
            alert("Name cannot contain parentheses.");
            return true;
        }

        // return false if no error
        return false;
    }

    function getResults(formID)
    {
        let form = document.getElementById(formID);
        let errorFlag = sanitizeInput(form.name.value);

        if (!errorFlag)
        {
            let newItem = {
                "name": form.name.value,
                "Descriptors": {
                    "rarity": form.rarity.value,
                    "attunement": form.attunement.value,
                    "typeofitem": form.typeofitem.value,
                    "description": form.description.value
                }
            }

            let itemJSON = JSON.stringify(newItem);
            let filename = newItem.name + ".json";

            google.script.run.createItemJSON(filename, itemJSON, newItem.name);
            alert(filename + " successfully created.");
            google.script.host.close();
        }
    }
    
</script>